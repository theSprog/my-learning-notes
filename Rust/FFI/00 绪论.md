### FFI调用约定

任何调用约定都必须要考虑这三个问题：

- 参数是采用栈传递还是寄存器传递，如果是栈传递，参数是顺序压栈还是逆序压栈，如果是寄存器传递，寄存器如何和参数列表对应
- 是谁负责清栈，调用方还是被调用方
- 返回值是通过什么方式传递



在 GNU C 编译器中，默认采用 cdecl 调用约定，该约定优点在于支持不定参数。除此之外还有 stdcall 调用，fastcall 调用。

stdcall 只支持 32 位机，64位下无法胜任。

```c
// gnu C 下更改调用约定, 需要加 __attribute__((__xxx__))
// 比如设定调用约定为 __stdcall__
int __attribute__((__stdcall__)) func()
```

